<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by perltidy on Sun Dec  3 23:23:11 2006 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>2006 Perl Advent Calendar: Grandma Got Run Over by a Reindeer</title>
<link rel="stylesheet" href="../style.css" type="text/css" /></head>
<body>
<H1><A HREF="../">Perl Advent Calendar 2006-12</A>-10</H1>
<H2 ALIGN="CENTER">Grandma Got Run Over by a Reindeer</H2>
<H3 ALIGN="CENTER">by Jerrad Pierce</H3>

<p>
Santa may be jolly, but he's also mighty strict. The jolly old elf was quite
pleased when he recently discovered a module to help him cope with code that
does not comply with best practices. Better yet, it's part of the core
distribution. Through the addition of a thin wrapper,
<tt><a href="http://perldoc.perl.org/Fatal.html">Fatal</a></tt> induces
subroutines and functions that would otherwise return false when an error
occurs to instead throw an exception. This has several advantages including
error propagation and the ability to compensate for nonexistent error-handling
in code you do not control. Unfortunately, the current version (1.03) thwarts
this latter benefit as noted 
<a href="http://beta.nntp.perl.org/group/perl.perl5.porters/2006/12/msg119059.html">here on p5p</a>.
The patch offered in the message is available below, and required by the sample code.
</p>

<h1><a href="mod10.pl">mod10.pl</a> - Requires this <a href="patch">patch</a></h1>
<hr />
<pre>
<a name="package-main-"></a>   1 <span class="k">package </span><span class="i">main</span><span class="sc">;</span>
   2 <span class="k">use</span> <span class="w">Fatal</span> <span class="q">qw/CORE::GLOBAL::open CORE::GLOBAL::close/</span><span class="sc">;</span>
   3 
   4 <span class="k">eval</span><span class="s">{</span> <span class="i">Note::thankYou</span><span class="s">(</span><span class="q">qw/Alvin Bobby Cindy David Erica Freddie/</span><span class="s">)</span> <span class="s">}</span><span class="sc">;</span>
   5 <span class="k">warn</span><span class="s">(</span><span class="q">&quot;Naughty package! $@\n&quot;</span><span class="s">)</span> <span class="k">if</span> <span class="i">$@</span><span class="sc">;</span>
   6 
   7 
<a name="package-Note-"></a>   8 <span class="k">package </span><span class="i">Note</span><span class="sc">;</span>
   9 <span class="k">use</span> <span class="w">File::Temp</span> <span class="q">'tmpnam'</span><span class="sc">;</span>
  10 
<a name="thankYou-"></a>  11 <span class="k">sub </span><span class="m">thankYou</span><span class="s">{</span>
  12   <span class="k">foreach</span> <span class="k">my</span> <span class="i">$child</span> <span class="s">(</span><span class="i">@_</span> <span class="s">)</span><span class="s">{</span>
  13     <span class="k">my</span><span class="s">(</span><span class="i">$fh</span><span class="cm">,</span> <span class="i">$file</span><span class="s">)</span> = <span class="i">tmpnam</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  14 
  15     <span class="c">#Compose thank you for exceptional cookies and milk...</span>
  16     
  17     <span class="c">#strict-less example using typo to force failure in closing unopened handle</span>
  18     <span class="k">close</span><span class="s">(</span><span class="i">$Fh</span><span class="s">)</span><span class="sc">;</span>
  19 
  20     <span class="c">#Do something with the message $file</span>
  21   <span class="s">}</span>
  22 <span class="s">}</span>
<a name="EOF-"></a></pre>
</body>
</html>
